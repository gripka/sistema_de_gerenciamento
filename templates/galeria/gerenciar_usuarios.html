{% extends 'base.html' %}
{% load static %}

{% block content %}

<link rel="stylesheet" type="text/css" href="{% static 'styles/gerenciar_usuarios.css' %}">

<div class="container-geral">
    <div class="botoes-container">
        <a href="{% url 'galeria:cadastro' %}" class="botao botao-cadastrar">Cadastrar Usuário</a>
        <a href="{% url 'galeria:editar_usuario' %}" class="botao botao-editar">Editar Usuário</a>
    </div>

    <div class="usuarios-cadastrados-container">
        <h2>Usuários Cadastrados</h2>

        <div class="tabela-usuarios">
            <div class="cabecalho-tabela">
                <div class="coluna">Nome</div>
                <div class="coluna">E-mail</div>
                <div class="coluna">Perfil</div>
                <div class="coluna">Ações</div>
            </div>

            {% for usuario in usuarios %}
                <div class="linha-tabela">
                    <div class="coluna">{{ usuario.get_full_name }}</div>
                    <div class="coluna">{{ usuario.email }}</div>
                    <div class="coluna">
                        {% for grupo in usuario.groups.all %}
                            {{ grupo.name }}
                        {% endfor %}
                    </div>
                    <div class="coluna acoes">
                        <a href="{% url 'galeria:editar_usuario_id' usuario.id %}" class="botao-editar-usuario">Editar</a>

                        <button type="button" class="botao-excluir-usuario" data-bs-toggle="modal" data-bs-target="#excluirModal{{ usuario.id }}">
                            Excluir
                        </button>

                        <div class="modal fade" id="excluirModal{{ usuario.id }}" tabindex="-1" aria-labelledby="excluirModalLabel{{ usuario.id }}" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="excluirModalLabel{{ usuario.id }}">Confirmar Exclusão</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        Tem certeza que deseja excluir o usuário {{ usuario.username }}?
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                        <form method="post" action="{% url 'galeria:gerenciar_usuarios' %}">
                                            {% csrf_token %}
                                            <input type="hidden" name="usuario_id" value="{{ usuario.id }}">
                                            <button type="submit" class="btn btn-danger">Excluir</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>
            {% endfor %}
        </div>

        <div class="paginacao">
            <span class="pagina-atual">página 1 - 78</span>
        </div>
    </div>

    <div class="busca-container">
        <form method="get">
            <input type="text" name="q" placeholder="Pesquisar" class="campo-pesquisa">
            <button type="submit" class="botao-buscar">Buscar</button>
        </form>
    </div>

    <div class="salvar-container">
        <button class="botao-salvar">Salvar</button>
    </div>
</div>

{% endblock %}
